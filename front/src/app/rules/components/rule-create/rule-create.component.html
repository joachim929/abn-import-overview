<mat-card class="rule-container">
  <mat-card-title>Create a new rule...</mat-card-title>
  <mat-card-content>
    <form [formGroup]="ruleForm">
      <app-mat-input [control]="ruleForm.get('name')"
                     type="text"
                     hint="A name to describe the rule"
                     error="Field must be filled"
                     errorType="required"
                     label="Name"></app-mat-input>
      <hr>
      <div formArrayName="amount">
        <mat-label>Amount logic</mat-label>
        <div style="display: grid; grid-template-columns: 4fr 1fr">
          <div [formGroup]="ruleGroup" *ngFor="let ruleGroup of getArray('amount').controls; let index = index">
            <app-mat-select
              [options]="amountOptions"
              label="Rule"
              [control]="ruleGroup.get('rule')"></app-mat-select>
            <app-mat-input [control]="ruleGroup.get('value')" type="number" label="value"></app-mat-input>
            <button [disabled]="ruleGroup.invalid"
                    *ngIf="index === (getArray('amount').controls.length)" mat-raised-button></button>
          </div>
        </div>
      </div>
      <hr>
      <div formArrayName="description">
        <mat-label>Description logic</mat-label>
        <div [formGroup]="ruleGroup" *ngFor="let ruleGroup of getArray('description').controls; let index = index">
          <app-mat-select
            [control]="ruleGroup.get('rule')"
            label="Rule"
            [options]="descriptionOptions"></app-mat-select>
          <app-mat-input [control]="ruleGroup.get('value')" type="text" label="value"></app-mat-input>
        </div>
      </div>
      <hr>
      <app-mat-select-groups
        [groups]="categoryGroups"
        groupKey="category"
        [control]="ruleForm.get('categoryId')"
        label="Category"></app-mat-select-groups>
      <mat-checkbox color="primary" formControlName="autoAssign">Auto assign</mat-checkbox>
      <hr>
      <button mat-raised-button>Add</button>
      <!-- todo: go back-->
      <button mat-raised-button>Cancel</button>
      <button mat-raised-button>Reset</button>
    </form>
  </mat-card-content>
</mat-card>
